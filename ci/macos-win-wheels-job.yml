jobs:
  - job: build_wheels
    strategy:
      matrix:
        macos-latest-py38:
          VM_IMAGE: macos-latest
          PYTHON_VERSION: 3.8
        macos-latest-py39:
          VM_IMAGE: macos-latest
          PYTHON_VERSION: 3.9
        macos-latest-py310:
          VM_IMAGE: macos-latest
          PYTHON_VERSION: 3.10
        macos-latest-py311:
          VM_IMAGE: macos-latest
          PYTHON_VERSION: 3.11
        windows-latest-py38:
          VM_IMAGE: windows-latest
          PYTHON_VERSION: 3.8
        windows-latest-py39:
          VM_IMAGE: windows-latest
          PYTHON_VERSION: 3.9
        windows-latest-py310:
          VM_IMAGE: windows-latest
          PYTHON_VERSION: 3.10
        windows-latest-py311:
          VM_IMAGE: windows-latest
          PYTHON_VERSION: 3.11
    continueOnError: true
    pool:
      vmImage: '$(VM_IMAGE)'
    steps:
      - checkout: self
        submodules: recursive
      - task: UsePythonVersion@0
        inputs:
          versionSpec: '$(PYTHON_VERSION)'
      - script: python -m pip install --upgrade pip setuptools wheel cibuildwheel
        displayName: Install Python pip tools
      - script: python -m pip wheel -w wheelhouse .
        displayName: Build wheel
      - task: PublishBuildArtifacts@1
        inputs:
          pathtoPublish: 'wheelhouse'
          artifactName: 'Wheels'

