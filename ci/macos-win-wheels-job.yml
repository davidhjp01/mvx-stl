jobs:
  - job: build_wheels
    strategy:
      matrix:
        macos-latest-py35:
          VM_IMAGE: macos-latest
          PYTHON_VERSION: 3.5
        macos-latest-py36:
          VM_IMAGE: macos-latest
          PYTHON_VERSION: 3.6
        macos-latest-py37:
          VM_IMAGE: macos-latest
          PYTHON_VERSION: 3.7
        macos-latest-py38:
          VM_IMAGE: macos-latest
          PYTHON_VERSION: 3.8
        windows-latest-py35:
          VM_IMAGE: windows-latest
          PYTHON_VERSION: 3.5
        windows-latest-py36:
          VM_IMAGE: windows-latest
          PYTHON_VERSION: 3.6
        windows-latest-py37:
          VM_IMAGE: windows-latest
          PYTHON_VERSION: 3.7
        windows-latest-py38:
          VM_IMAGE: windows-latest
          PYTHON_VERSION: 3.8
    continueOnError: true
    pool:
      vmImage: '$(VM_IMAGE)'
    steps:
      - checkout: self
        submodules: recursive
      - task: UsePythonVersion@0
        inputs:
          versionSpec: '$(PYTHON_VERSION)'
      - script: python -m pip install --upgrade pip setuptools wheel cibuildwheel
        displayName: Install Python pip tools
      - script: python -m pip wheel -w wheelhouse .
        displayName: Build wheel
      - task: PublishBuildArtifacts@1
        inputs:
          pathtoPublish: 'wheelhouse'
          artifactName: 'Wheels'

